<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xyauto.mapper.AppMapper">
	<select id="findBoardInfoByOfficeId" parameterType="java.lang.Integer"
		resultMap="com.xyauto.mapper.BoardroomInfoMapper.BaseResultMap">
		select
		A.bi_id,A.office_id,A.bi_name,A.bi_floor,A.bi_capacity
		from
		[xyauto_meet].[dbo].[boardroom_info] as A
		where
		A.office_id=#{officeId,jdbcType=INTEGER}
		and
		A.is_delete=0
		and A.status=1
	</select>
	<select id="findScheInfoByReq" parameterType="map" resultMap="com.xyauto.mapper.ScheduledRecordMapper.BaseResultMap">
		select
		A.sr_id,A.bi_id,A.start_time,A.end_time
		from
		[xyauto_meet].[dbo].[scheduled_record] as A
		where
		A.is_delete=0
		and
		convert(char(10),A.start_time,120)=#{startTime,jdbcType=VARCHAR}
		and
		A.office_id=#{officeId,jdbcType=INTEGER}
	</select>
	<select id="findInfoByBiId" parameterType="map" resultMap="com.xyauto.mapper.ScheduledRecordMapper.BaseResultMap">
		select
		A.sr_id,A.start_time,A.end_time
		from
		[xyauto_meet].[dbo].[scheduled_record] A
		where
		and
		A.is_delete=0
		CONVERT(char(10),A.start_time,120)=#{startTime,jdbcType=VARCHAR}
		and
		A.bi_id=#{biId,jdbcType=VARCHAR}
	</select>
	<select id="checkMeetTime" parameterType="map" resultType="java.lang.Integer">
		select COUNT(*) count from [xyauto_meet].[dbo].[scheduled_record] A
		where
		#{startTime,jdbcType=TIMESTAMP} &lt;=a.end_time and
		#{endTime,jdbcType=TIMESTAMP}>=a.start_time
		and
		A.bi_id=#{biId,jdbcType=VARCHAR}
		and A.is_delete=0
	</select>
	<insert id="insertByBatch" parameterType="java.util.List">
		insert into [xyauto_meet].[dbo].[attendees] (
		sr_id,
		employee_id,
		employee_name,
		is_delete,
		create_user,
		update_time,
		update_user
		)
		values
		<foreach collection="list" item="item" index="index"
			separator=",">
			(
			#{item.srId,jdbcType=CHAR},
			#{item.employeeId,jdbcType=VARCHAR},
			#{item.employeeName,jdbcType=NVARCHAR},
			#{item.isDelete,jdbcType=BIT},
			#{item.createUser,jdbcType=VARCHAR},
			CURRENT_TIMESTAMP,
			#{item.updateUser,jdbcType=VARCHAR}
			)
		</foreach>
	</insert>
</mapper>